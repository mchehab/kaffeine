name: kaffeine-player
version-script: cat Changelog |grep Version|head -1|cut -d' ' -f2
version: "snapshot"
summary: A media player by KDE with digital TV support
confinement: devmode
grade: devel
description: |
  Kaffeine is a media player. What makes it different from the others is
  its excellent support of digital TV (DVB). kaffeine-player has user-friendly
  interface, so that even first time users can start immediately playing
  their movies: from DVD (including DVD menus, titles, chapters, etc.),
  VCD, or a file.

apps:
  kaffeine-player:
    desktop: share/applications/org.kde.kaffeine.desktop
    command: bin/desktop-launch kaffeine
    plugs:
      - camera
      - desktop
      - desktop-legacy
      - home
      - mount-observe
      - network
      - network-bind
      - opengl
      - optical-drive
      - pulseaudio
      - removable-media
      - screen-inhibit-control
      - unity7
      - x11
    slots:
      - mpris
parts:
  desktop-qt5-kaffeine:
    source: https://github.com/ubuntu/snapcraft-desktop-helpers.git
    source-commit: 3a6209d90bcec218618348f7f41c873bdacc723f
    source-subdir: qt/
    plugin: make
    make-parameters: ["FLAVOR=qt5"]
    build-packages:
      - qtbase5-dev
      - dpkg-dev
      - libatk1.0-dev
      - libgtk2.0-dev
    stage-packages:
      - libxkbcommon0
      - ttf-ubuntu-font-family
      - dmz-cursor-theme
      - light-themes
      - shared-mime-info
      - libqt5gui5
      - libgdk-pixbuf2.0-0
      - libqt5svg5 # for loading icon themes which are svg
      - libc6
      - locales-all

  kaffeine-player:
    after: [desktop-qt5-kaffeine]
    source: .
    source-type: git
    plugin: cmake
    build-packages:
      - cmake
      - extra-cmake-modules
      - g++
      - gettext
      - kdelibs5-dev
      - kio-dev
      - libdvbv5-dev
      - libkf5coreaddons-dev
      - libkf5i18n-dev
      - libkf5solid-dev
      - libkf5widgetsaddons-dev
      - libkf5windowsystem-dev
      - libqt5x11extras5-dev
      - libvlc-dev
      - libxss-dev
      - make
      - qt5-default
    stage-packages:
      - fonts-freefont-ttf
      - dbus-x11
      - libaa1
      - libcaca0
      - libcairo2
      - libegl1-mesa
      - libfreerdp-client1.1
      - libfreerdp-core1.1
      - libfreerdp-gdi1.1
      - libfreetype6
      - libfribidi0
      - libgcc1
      - libgl1-mesa-glx
      - libgles2-mesa
      - libglib2.0-0
      - libpulse0
      - libqt5core5a
      - libqt5gui5
      - librsvg2-2
      - libsdl-image1.2
      - libsdl1.2debian
      - libsecret-1-0
      - libvncclient1
      - libx11-6
      - libxcb-composite0
      - libxcb-keysyms1
      - libxcb-randr0
      - libxcb-shm0
      - libxcb-xv0
      - libxcb1
      - libxext6
      - libxi6
      - libxinerama1
      - libxpm4
      - vdpau-va-driver
      - i965-va-driver
      - mesa-utils
      - mesa-vdpau-drivers
      - zlib1g
      - libprojectm2v5
      - projectm-data
      - kde-style-breeze
      - breeze-icon-theme
      - frameworkintegration
      - plasma-integration
      - phonon4qt5-backend-null
      - libxcomposite1
      - libxrandr2
      - try:
        - libva-x11-1
        - libva1
        - libvdpau1
        - libva-drm1
